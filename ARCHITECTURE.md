# ğŸ—ï¸ Architecture ComplÃ¨te - IA Cleaner

Cette architecture montre comment les 3 systÃ¨mes coexistent de maniÃ¨re indÃ©pendante.

---

## ğŸ¯ Vue d'Ensemble

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        IA CLEANER                               â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   SYSTÃˆME    â”‚  â”‚   SYSTÃˆME    â”‚  â”‚   SYSTÃˆME    â”‚        â”‚
â”‚  â”‚   GÃ‰NÃ‰RAL    â”‚  â”‚   VOITURE    â”‚  â”‚   CANAPÃ‰     â”‚        â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚        â”‚
â”‚  â”‚  IntÃ©rieurs  â”‚  â”‚  IntÃ©rieurs  â”‚  â”‚  CanapÃ©s &   â”‚        â”‚
â”‚  â”‚  Cuisines    â”‚  â”‚  Automobiles â”‚  â”‚  Salons      â”‚        â”‚
â”‚  â”‚  Salles bain â”‚  â”‚              â”‚  â”‚              â”‚        â”‚
â”‚  â”‚  ExtÃ©rieurs  â”‚  â”‚  ğŸš—          â”‚  â”‚  ğŸ›‹ï¸          â”‚        â”‚
â”‚  â”‚  Piscines    â”‚  â”‚              â”‚  â”‚              â”‚        â”‚
â”‚  â”‚  etc.        â”‚  â”‚              â”‚  â”‚              â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚         â†“                 â†“                  â†“                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚/api/clean-   â”‚  â”‚/api/clean-   â”‚  â”‚/api/clean-   â”‚        â”‚
â”‚  â”‚   image      â”‚  â”‚    car       â”‚  â”‚   sofa       â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš— SystÃ¨me Voiture - Flux Complet

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ENTRÃ‰E: Image IntÃ©rieur Voiture                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰TAPE 1: DÃ©tection Type d'Espace                               â”‚
â”‚                                                                 â”‚
â”‚  Prompt: getCarSpaceTypeDetectionPrompt()                      â”‚
â”‚  â†“                                                              â”‚
â”‚  Gemini 2.5 Flash (temp=0, topK=1, topP=0.1)                  â”‚
â”‚  â†“                                                              â”‚
â”‚  RÃ©sultat: car-interior-full | car-seats |                     â”‚
â”‚            car-dashboard | car-trunk                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰TAPE 2: Analyse Ultra-DÃ©taillÃ©e                               â”‚
â”‚                                                                 â”‚
â”‚  Prompt: getCarAnalysisPrompt()                                â”‚
â”‚  â†“                                                              â”‚
â”‚  Analyse de:                                                    â”‚
â”‚  - CamÃ©ra & Perspective (exact)                                â”‚
â”‚  - Structure intÃ©rieur (configuration siÃ¨ges, dashboard)       â”‚
â”‚  - MatÃ©riaux & Textures (cuir, tissu, plastique)              â”‚
â”‚  - Lighting & AtmosphÃ¨re                                        â”‚
â”‚  - Palette de couleurs (exact)                                 â”‚
â”‚  - Clutter & Mess (TOUTES particules/miettes)                 â”‚
â”‚  - Ã‰lÃ©ments Ã  prÃ©server (exact positions)                     â”‚
â”‚  â†“                                                              â”‚
â”‚  Gemini 2.5 Flash (temp=0, topK=40, topP=0.95)               â”‚
â”‚  â†“                                                              â”‚
â”‚  RÃ©sultat: Analyse textuelle dÃ©taillÃ©e (5000+ mots)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰TAPE 3: GÃ©nÃ©ration Image NettoyÃ©e                             â”‚
â”‚                                                                 â”‚
â”‚  Mode sÃ©lectionnÃ©: perfect-clean | enhanced-beauty |           â”‚
â”‚                    stylized-luxury                             â”‚
â”‚  â†“                                                              â”‚
â”‚  Configuration selon mode:                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Mode               â”‚ Fid  â”‚ Temp â”‚ TopK â”‚ TopP   â”‚        â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚  â”‚ perfect-clean      â”‚ 92%  â”‚ 0.1  â”‚  20  â”‚ 0.8    â”‚        â”‚
â”‚  â”‚ enhanced-beauty    â”‚ 85%  â”‚ 0.2  â”‚  25  â”‚ 0.85   â”‚        â”‚
â”‚  â”‚ stylized-luxury    â”‚ 70%  â”‚ 0.4  â”‚  40  â”‚ 0.95   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚  â†“                                                              â”‚
â”‚  Prompt: getCarGenerationPrompt(mode, analysis, spaceType)    â”‚
â”‚  â†“                                                              â”‚
â”‚  Gemini 2.5 Flash Image (config selon mode)                   â”‚
â”‚  â†“                                                              â”‚
â”‚  RÃ©sultat: Image Buffer (nettoyÃ©e selon mode)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰TAPE 4: Upload Cloudinary                                     â”‚
â”‚                                                                 â”‚
â”‚  Folder: clear-ai/car/                                         â”‚
â”‚  PublicId: car_{mode}_{timestamp}                             â”‚
â”‚  â†“                                                              â”‚
â”‚  RÃ©sultat: URL optimisÃ©e                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SORTIE: Image NettoyÃ©e + MÃ©tadonnÃ©es                           â”‚
â”‚                                                                 â”‚
â”‚  {                                                              â”‚
â”‚    success: true,                                              â”‚
â”‚    generatedImageUrl: "https://...",                          â”‚
â”‚    meta: {                                                     â”‚
â”‚      spaceType: "car-interior-full",                          â”‚
â”‚      renderMode: "perfect-clean",                             â”‚
â”‚      width: 1920,                                              â”‚
â”‚      height: 1080,                                             â”‚
â”‚      analysisText: "..."                                       â”‚
â”‚    }                                                           â”‚
â”‚  }                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ›‹ï¸ SystÃ¨me CanapÃ© - Flux Complet

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ENTRÃ‰E: Image CanapÃ©/Salon                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰TAPE 1: DÃ©tection Type d'Espace                               â”‚
â”‚                                                                 â”‚
â”‚  Prompt: getSofaSpaceTypeDetectionPrompt()                     â”‚
â”‚  â†“                                                              â”‚
â”‚  Gemini 2.5 Flash (temp=0, topK=1, topP=0.1)                  â”‚
â”‚  â†“                                                              â”‚
â”‚  RÃ©sultat: sofa | sofa-living-room |                           â”‚
â”‚            living-room-full | armchair                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰TAPE 2: Analyse Ultra-DÃ©taillÃ©e                               â”‚
â”‚                                                                 â”‚
â”‚  Prompt: getSofaAnalysisPrompt()                               â”‚
â”‚  â†“                                                              â”‚
â”‚  Analyse de:                                                    â”‚
â”‚  - CamÃ©ra & Perspective (exact)                                â”‚
â”‚  - Structure canapÃ© (configuration, style, taille)             â”‚
â”‚  - MatÃ©riaux & Tissu (cuir, microsuÃ¨de, velours, etc.)        â”‚
â”‚  - Cleanliness baseline (Ã©tat actuel dÃ©taillÃ©)                â”‚
â”‚  - Contexte salon (si visible)                                 â”‚
â”‚  - Lighting & AtmosphÃ¨re                                        â”‚
â”‚  - Palette de couleurs (exact)                                 â”‚
â”‚  - Clutter & Mess (taches, saletÃ©, pilling)                   â”‚
â”‚  - Ã‰lÃ©ments Ã  prÃ©server (exact positions coussins)            â”‚
â”‚  â†“                                                              â”‚
â”‚  Gemini 2.5 Flash (temp=0, topK=40, topP=0.95)               â”‚
â”‚  â†“                                                              â”‚
â”‚  RÃ©sultat: Analyse textuelle dÃ©taillÃ©e (5000+ mots)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰TAPE 3: GÃ©nÃ©ration Image NettoyÃ©e                             â”‚
â”‚                                                                 â”‚
â”‚  Mode sÃ©lectionnÃ©: professional-clean | magazine-worthy |      â”‚
â”‚                    designer-dream                              â”‚
â”‚  â†“                                                              â”‚
â”‚  Configuration selon mode:                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Mode               â”‚ Fid  â”‚ Temp â”‚ TopK â”‚ TopP   â”‚        â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚  â”‚ professional-clean â”‚ 95%  â”‚ 0.05 â”‚  15  â”‚ 0.75   â”‚        â”‚
â”‚  â”‚ magazine-worthy    â”‚ 85%  â”‚ 0.15 â”‚  30  â”‚ 0.85   â”‚        â”‚
â”‚  â”‚ designer-dream     â”‚ 70%  â”‚ 0.35 â”‚  45  â”‚ 0.95   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚  â†“                                                              â”‚
â”‚  Prompt: getSofaGenerationPrompt(mode, analysis, spaceType)   â”‚
â”‚  â†“                                                              â”‚
â”‚  Gemini 2.5 Flash Image (config selon mode)                   â”‚
â”‚  â†“                                                              â”‚
â”‚  RÃ©sultat: Image Buffer (nettoyÃ©e selon mode)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰TAPE 4: Upload Cloudinary                                     â”‚
â”‚                                                                 â”‚
â”‚  Folder: clear-ai/sofa/                                        â”‚
â”‚  PublicId: sofa_{mode}_{timestamp}                            â”‚
â”‚  â†“                                                              â”‚
â”‚  RÃ©sultat: URL optimisÃ©e                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SORTIE: Image NettoyÃ©e + MÃ©tadonnÃ©es                           â”‚
â”‚                                                                 â”‚
â”‚  {                                                              â”‚
â”‚    success: true,                                              â”‚
â”‚    generatedImageUrl: "https://...",                          â”‚
â”‚    meta: {                                                     â”‚
â”‚      spaceType: "sofa-living-room",                           â”‚
â”‚      renderMode: "professional-clean",                        â”‚
â”‚      width: 1920,                                              â”‚
â”‚      height: 1080,                                             â”‚
â”‚      analysisText: "..."                                       â”‚
â”‚    }                                                           â”‚
â”‚  }                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‚ Organisation du Code

### Structure HiÃ©rarchique

```
lib/
â”œâ”€â”€ types/                          # TYPES
â”‚   â”œâ”€â”€ car-types.ts               # â† Types voiture (indÃ©pendants)
â”‚   â”œâ”€â”€ sofa-types.ts              # â† Types canapÃ© (indÃ©pendants)
â”‚   â””â”€â”€ index.ts                   # Export centralisÃ©
â”‚
â”œâ”€â”€ prompts/                        # PROMPTS
â”‚   â”œâ”€â”€ car-prompts/               # â† Prompts voiture
â”‚   â”‚   â”œâ”€â”€ detection.ts          # DÃ©tection type espace auto
â”‚   â”‚   â”œâ”€â”€ analysis.ts           # Analyse ultra-dÃ©taillÃ©e auto
â”‚   â”‚   â”œâ”€â”€ generation.ts         # GÃ©nÃ©ration (3 modes)
â”‚   â”‚   â””â”€â”€ index.ts              # Export
â”‚   â”‚
â”‚   â”œâ”€â”€ sofa-prompts/              # â† Prompts canapÃ©
â”‚   â”‚   â”œâ”€â”€ detection.ts          # DÃ©tection type espace canapÃ©
â”‚   â”‚   â”œâ”€â”€ analysis.ts           # Analyse ultra-dÃ©taillÃ©e canapÃ©
â”‚   â”‚   â”œâ”€â”€ generation.ts         # GÃ©nÃ©ration (3 modes)
â”‚   â”‚   â””â”€â”€ index.ts              # Export
â”‚   â”‚
â”‚   â””â”€â”€ index.ts                   # Export centralisÃ©
â”‚
â”œâ”€â”€ api/                            # PROCESSORS
â”‚   â””â”€â”€ processors/
â”‚       â”œâ”€â”€ car-processor.ts       # â† Logique complÃ¨te voiture
â”‚       â”œâ”€â”€ sofa-processor.ts      # â† Logique complÃ¨te canapÃ©
â”‚       â””â”€â”€ index.ts               # Export
â”‚
â”œâ”€â”€ gemini.ts                       # SystÃ¨me gÃ©nÃ©ral (existant)
â””â”€â”€ prompts.ts                      # Prompts gÃ©nÃ©ral (existant)

app/
â””â”€â”€ api/                            # ENDPOINTS
    â”œâ”€â”€ clean-image/               # Endpoint gÃ©nÃ©ral (existant)
    â”‚   â””â”€â”€ route.ts
    â”‚
    â”œâ”€â”€ clean-car/                 # â† Endpoint voiture
    â”‚   â””â”€â”€ route.ts
    â”‚
    â””â”€â”€ clean-sofa/                # â† Endpoint canapÃ©
        â””â”€â”€ route.ts
```

---

## ğŸ”„ Flux de DonnÃ©es

### RequÃªte â†’ RÃ©ponse

```
CLIENT
  â†“
  â”‚ POST /api/clean-car
  â”‚ - image: File
  â”‚ - renderMode: "perfect-clean"
  â†“
ENDPOINT (route.ts)
  â†“
  â”‚ Validation entrÃ©es
  â”‚ Optimisation image
  â†“
PROCESSOR (car-processor.ts)
  â†“
  â”œâ”€â†’ detectCarSpaceType()
  â”‚     â†“ Gemini API
  â”‚     â†“ car-interior-full
  â”‚
  â”œâ”€â†’ analyzeCarInterior()
  â”‚     â†“ Gemini API
  â”‚     â†“ Analyse dÃ©taillÃ©e (5000+ mots)
  â”‚
  â””â”€â†’ generateCleanCarImage()
        â†“ Gemini API (mode-specific config)
        â†“ Image Buffer
  â†“
CLOUDINARY
  â†“ Upload
  â†“ URL optimisÃ©e
  â†“
ENDPOINT
  â†“ Format response JSON
  â†“
CLIENT
  â† {success, generatedImageUrl, meta}
```

---

## ğŸ¨ Modes de Rendu - Comparaison

### Voiture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mode            â”‚ FidÃ©litÃ© â”‚ CrÃ©ativitÃ© â”‚ Use Case        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ perfect-clean   â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚ â–ˆâ–ˆ         â”‚ Avant/AprÃ¨s     â”‚
â”‚                 â”‚   92%    â”‚ TrÃ¨s faibleâ”‚ Services clean  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ enhanced-beauty â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â”‚ â–ˆâ–ˆâ–ˆâ–ˆ       â”‚ Marketing       â”‚
â”‚                 â”‚   85%    â”‚ ModÃ©rÃ©e    â”‚ Brochures       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ stylized-luxury â”‚ â–ˆâ–ˆâ–ˆâ–ˆ     â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â”‚ Social Media    â”‚
â”‚                 â”‚   70%    â”‚ Ã‰levÃ©e     â”‚ Pinterest       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### CanapÃ©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mode             â”‚ FidÃ©litÃ© â”‚ CrÃ©ativitÃ© â”‚ Use Case        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ professional-    â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚ â–ˆ          â”‚ Nettoyage pro   â”‚
â”‚ clean            â”‚   95%    â”‚ Ultra-faible Annonces       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ magazine-worthy  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â”‚ â–ˆâ–ˆâ–ˆâ–ˆ       â”‚ Magazines dÃ©co  â”‚
â”‚                  â”‚   85%    â”‚ ModÃ©rÃ©e    â”‚ Portfolios      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ designer-dream   â”‚ â–ˆâ–ˆâ–ˆâ–ˆ     â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â”‚ Instagram       â”‚
â”‚                  â”‚   70%    â”‚ Ã‰levÃ©e     â”‚ Pinterest       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§© IntÃ©gration avec l'Existant

```
AVANT (SystÃ¨me gÃ©nÃ©ral seulement)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  /api/clean-image                   â”‚
â”‚  â†“                                  â”‚
â”‚  lib/gemini.ts                      â”‚
â”‚  â†“                                  â”‚
â”‚  lib/prompts.ts                     â”‚
â”‚  - interior                         â”‚
â”‚  - kitchen                          â”‚
â”‚  - bathroom                         â”‚
â”‚  - outdoor                          â”‚
â”‚  - pool                             â”‚
â”‚  - balcony                          â”‚
â”‚  - garage                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

APRÃˆS (3 systÃ¨mes indÃ©pendants)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GÃ‰NÃ‰RAL        â”‚ VOITURE        â”‚ CANAPÃ‰         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /api/clean-    â”‚ /api/clean-car â”‚ /api/clean-    â”‚
â”‚ image          â”‚                â”‚ sofa           â”‚
â”‚ â†“              â”‚ â†“              â”‚ â†“              â”‚
â”‚ lib/gemini.ts  â”‚ lib/api/       â”‚ lib/api/       â”‚
â”‚                â”‚ processors/    â”‚ processors/    â”‚
â”‚ lib/prompts.ts â”‚ car-processor  â”‚ sofa-processor â”‚
â”‚                â”‚ â†“              â”‚ â†“              â”‚
â”‚ - interior     â”‚ lib/prompts/   â”‚ lib/prompts/   â”‚
â”‚ - kitchen      â”‚ car-prompts/   â”‚ sofa-prompts/  â”‚
â”‚ - bathroom     â”‚                â”‚                â”‚
â”‚ - outdoor      â”‚ lib/types/     â”‚ lib/types/     â”‚
â”‚ - pool         â”‚ car-types      â”‚ sofa-types     â”‚
â”‚ - balcony      â”‚                â”‚                â”‚
â”‚ - garage       â”‚                â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš ï¸ INDÃ‰PENDANCE TOTALE : Aucun conflit entre systÃ¨mes
```

---

## ğŸ’¡ Pourquoi cette Architecture ?

### SÃ©paration des PrÃ©occupations

**ProblÃ¨me** : Chaque domaine a des problÃ¨mes ultra-spÃ©cifiques
- **Voiture** : Particules microscopiques, gÃ©omÃ©trie complexe
- **CanapÃ©** : Tissus variÃ©s, taches absorbÃ©es, pilling

**Solution** : SystÃ¨mes complÃ¨tement indÃ©pendants
- Types sÃ©parÃ©s
- Prompts spÃ©cialisÃ©s
- Logique dÃ©diÃ©e
- Endpoints distincts

### Avantages

âœ… **SpÃ©cialisation** - Chaque systÃ¨me optimisÃ© pour son domaine
âœ… **Maintenance** - Modifications isolÃ©es, pas de rÃ©gression
âœ… **Ã‰volution** - Ajout facile de nouveaux systÃ¨mes
âœ… **Tests** - Validation indÃ©pendante par systÃ¨me
âœ… **Performance** - Configuration optimale par domaine

---

## ğŸ“Š MÃ©triques de QualitÃ©

### FidÃ©litÃ© par Niveau

```
100% â”‚                  â–  Professional Clean (95%)
     â”‚                  â”‚
 90% â”‚        â–  Perfect Clean (92%)
     â”‚        â”‚         â”‚
 80% â”‚        â”‚    â– â”€â”€â”€â”€â”¼â”€â”€â”€â”€ Enhanced/Magazine (85%)
     â”‚        â”‚    â”‚    â”‚
 70% â”‚        â”‚    â”‚    â”‚    â–  Stylized/Designer (70%)
     â”‚        â”‚    â”‚    â”‚    â”‚
 60% â”‚        â”‚    â”‚    â”‚    â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€
     â”‚    VOITURE   CANAPÃ‰
```

### CrÃ©ativitÃ© vs FidÃ©litÃ©

```
CrÃ©ativitÃ©
    â†‘
    â”‚
100%â”‚              â— Stylized/Designer
    â”‚             â—
    â”‚            â—
 50%â”‚         â— Enhanced/Magazine
    â”‚        â—
    â”‚       â—
    â”‚      â— Perfect/Professional
  0%â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ FidÃ©litÃ©
    0%    70%    85%    92%    95%  100%
```

---

## ğŸ¯ Points ClÃ©s

1. **3 systÃ¨mes indÃ©pendants** - GÃ©nÃ©ral, Voiture, CanapÃ©
2. **6 modes de rendu au total** - 3 par systÃ¨me spÃ©cialisÃ©
3. **Prompts ultra-spÃ©cialisÃ©s** - 5000+ mots d'analyse par domaine
4. **Configuration adaptative** - Temperature/topK/topP par mode
5. **Seed dÃ©terministe** - ReproductibilitÃ© garantie
6. **Aucune interfÃ©rence** - SystÃ¨mes totalement isolÃ©s

---

## ğŸš€ RÃ©sultat Final

Un systÃ¨me IA de nettoyage d'images avec **3 domaines d'expertise** :

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              IA CLEANER v2.0                        â”‚
â”‚                                                     â”‚
â”‚  ğŸ  SystÃ¨me GÃ©nÃ©ral (10 types d'espaces)           â”‚
â”‚     â†’ IntÃ©rieurs, cuisines, salles de bain, etc.   â”‚
â”‚                                                     â”‚
â”‚  ğŸš— SystÃ¨me Voiture (4 types d'espaces)            â”‚
â”‚     â†’ Habitacles, siÃ¨ges, tableaux de bord, coffre â”‚
â”‚     â†’ 3 modes: Perfect/Enhanced/Stylized           â”‚
â”‚     â†’ FidÃ©litÃ©: 92% / 85% / 70%                    â”‚
â”‚                                                     â”‚
â”‚  ğŸ›‹ï¸ SystÃ¨me CanapÃ© (4 types d'espaces)             â”‚
â”‚     â†’ CanapÃ©s, salons, fauteuils                   â”‚
â”‚     â†’ 3 modes: Professional/Magazine/Designer      â”‚
â”‚     â†’ FidÃ©litÃ©: 95% / 85% / 70%                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**PrÃªt pour les tests ! ğŸ‰**
